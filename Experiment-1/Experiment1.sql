
-- Question1
CREATE TABLE TBL_AUTHOR
(
	AUTHOR_ID INT PRIMARY KEY,
	AUTHOR_NAME VARCHAR(50),
	COUNTRY VARCHAR(50)
);

CREATE TABLE TBL_BOOK
(
	BOOK_ID INT PRIMARY KEY,
	BOOK_TITLE VARCHAR(50),
	AUTHOR_ID INT,

	FOREIGN KEY (AUTHOR_ID) REFERENCES TBL_AUTHOR(AUTHOR_ID)
);

INSERT INTO TBL_AUTHOR VALUES (1, 'Alice', 'USA');
INSERT INTO TBL_AUTHOR VALUES (2, 'Bob', 'UK');
INSERT INTO TBL_AUTHOR VALUES (3, 'Cathy', 'India');

INSERT INTO TBL_BOOK VALUES (101, 'Book A', 1);
INSERT INTO TBL_BOOK VALUES (102, 'Book B', 2);
INSERT INTO TBL_BOOK VALUES (103, 'Book C', 3);

SELECT 
	B.BOOK_TITLE, 
	A.AUTHOR_NAME, 
	A.COUNTRY
FROM 
	TBL_BOOK AS B
INNER JOIN 
	TBL_AUTHOR AS A 
ON 
	B.AUTHOR_ID = A.AUTHOR_ID;

-- Question2

CREATE TABLE STUDENT (
    STUDENT_ID INT PRIMARY KEY,
    STUDENT_NAME VARCHAR(50)
);

CREATE TABLE COURSE (
    COURSE_ID INT PRIMARY KEY,
    COURSE_NAME VARCHAR(50)
);

CREATE TABLE ENROLLMENT (
    ENROLLMENT_ID INT PRIMARY KEY,
    STUDENT_ID INT FOREIGN KEY REFERENCES STUDENT(STUDENT_ID),
    COURSE_ID INT FOREIGN KEY REFERENCES COURSE(COURSE_ID),
    GRADE CHAR(1)
);

INSERT INTO STUDENT VALUES (1, 'Alice');
INSERT INTO STUDENT VALUES (2, 'Bob');
INSERT INTO STUDENT VALUES (3, 'Charlie');

INSERT INTO COURSE VALUES (101, 'Data Structures');
INSERT INTO COURSE VALUES (102, 'Algorithms');
INSERT INTO COURSE VALUES (103, 'DBMS');
INSERT INTO COURSE VALUES (104, 'Operating Systems');
INSERT INTO COURSE VALUES (105, 'Networking');
INSERT INTO COURSE VALUES (106, 'Web Development');
INSERT INTO COURSE VALUES (107, 'Software Engineering');
INSERT INTO COURSE VALUES (108, 'Machine Learning');
INSERT INTO COURSE VALUES (109, 'Computer Graphics');
INSERT INTO COURSE VALUES (110, 'Cyber Security');

BEGIN TRANSACTION;
INSERT INTO ENROLLMENT VALUES (1, 1, 101, 'A');
SAVE TRANSACTION sp1;

BEGIN TRY
    INSERT INTO ENROLLMENT VALUES (2, 99, 102, 'B');
END TRY
BEGIN CATCH
    ROLLBACK TRANSACTION sp1;
END CATCH;

INSERT INTO ENROLLMENT VALUES (3, 2, 102, 'B');
INSERT INTO ENROLLMENT VALUES (4, 3, 103, 'C');
INSERT INTO ENROLLMENT VALUES (5, 2, 104, 'A');
INSERT INTO ENROLLMENT VALUES (6, 3, 105, 'B');
COMMIT TRANSACTION;
SELECT 
    S.STUDENT_NAME, 
    C.COURSE_NAME, 
    E.GRADE
FROM 
    ENROLLMENT E
JOIN STUDENT S ON E.STUDENT_ID = S.STUDENT_ID
JOIN COURSE C ON E.COURSE_ID = C.COURSE_ID;
